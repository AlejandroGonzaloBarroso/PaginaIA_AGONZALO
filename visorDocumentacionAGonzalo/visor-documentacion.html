<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visor de Documentaci√≥n - Advanced Documentation Manager</title>
    <meta name="description"
        content="Visor y editor avanzado de documentaci√≥n con soporte para m√∫ltiples archivos, edici√≥n en tiempo real y descarga">

    <!-- Monaco Editor -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>

    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Highlight.js for syntax highlighting in preview -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Fira+Code:wght@400;500;600&display=swap"
        rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Midnight Aurora Palette */
            --bg-primary: #030712;
            --bg-secondary: rgba(17, 24, 39, 0.7);
            --bg-tertiary: rgba(31, 41, 55, 0.5);
            --bg-hover: rgba(255, 255, 255, 0.08);
            --bg-active: rgba(255, 255, 255, 0.15);

            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-tertiary: #94a3b8;

            --accent-primary: #8b5cf6;
            --accent-secondary: #06b6d4;
            --accent-glow: 0 0 20px rgba(139, 92, 246, 0.5);
            --accent-gradient: linear-gradient(135deg, #06b6d4, #8b5cf6, #ec4899);

            --border-color: rgba(255, 255, 255, 0.08);
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.4);

            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background:
                radial-gradient(circle at 0% 0%, rgba(6, 182, 212, 0.15), transparent 40%),
                radial-gradient(circle at 100% 100%, rgba(236, 72, 153, 0.15), transparent 40%),
                var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: rgba(3, 7, 18, 0.6);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            padding: 0.8rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.25rem;
            font-weight: 700;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--accent-gradient);
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .search-box {
            position: relative;
            width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 0.75rem 1rem 0.75rem 2.75rem;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: var(--transition);
            font-family: inherit;
        }

        .search-input:focus {
            outline: none;
            background: rgba(0, 0, 0, 0.4);
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
            pointer-events: none;
        }

        .header-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .btn {
            padding: 0.6rem 1.25rem;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.03);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .btn-icon {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .btn-icon:hover {
            background: var(--bg-hover);
            color: white;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 65px);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(3, 7, 18, 0.4);
            backdrop-filter: blur(10px);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            transition: var(--transition);
        }

        .sidebar.collapsed {
            width: 0;
            overflow: hidden;
        }

        .sidebar-header {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-title {
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-tertiary);
        }

        .file-tree {
            flex: 1;
            overflow-y: auto;
            padding: 0.5rem;
        }

        .file-tree::-webkit-scrollbar {
            width: 6px;
        }

        .file-tree::-webkit-scrollbar-track {
            background: transparent;
        }

        .file-tree::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .tree-item {
            padding: 0.6rem 0.8rem;
            margin: 2px 0.5rem;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            font-weight: 500;
            border: 1px solid transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: var(--transition);
            user-select: none;
        }

        .tree-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .tree-item.active {
            background: rgba(139, 92, 246, 0.1);
            color: var(--accent-primary);
            border-color: rgba(139, 92, 246, 0.2);
            box-shadow: 0 0 10px rgba(139, 92, 246, 0.1);
        }

        .tree-item-icon {
            font-size: 1rem;
        }

        .tree-item-name {
            font-size: 0.875rem;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .tabs-container {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            padding: 0 1rem;
            gap: 0.5rem;
            overflow-x: auto;
        }

        .tab {
            padding: 0.75rem 1.25rem;
            background: transparent;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.875rem;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tab:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .tab.active {
            color: var(--accent-primary);
            border-bottom-color: var(--accent-primary);
        }

        .editor-toolbar {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 1rem;
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .toolbar-separator {
            width: 1px;
            height: 24px;
            background: var(--border-color);
            margin: 0 0.5rem;
        }

        .editor-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        #monaco-editor {
            width: 100%;
            height: 100%;
        }

        .preview-container {
            flex: 1;
            overflow-y: auto;
            padding: 2rem;
            background: var(--bg-primary);
        }

        .preview-content {
            max-width: 900px;
            margin: 0 auto;
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
        }

        .preview-content h1,
        .preview-content h2,
        .preview-content h3 {
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            line-height: 1.3;
        }

        .preview-content h1 {
            font-size: 2rem;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
        }

        .preview-content p {
            margin-bottom: 1rem;
            line-height: 1.7;
            color: var(--text-secondary);
        }

        .preview-content code {
            background: var(--bg-tertiary);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Fira Code', monospace;
        }

        .preview-content pre {
            background: var(--bg-tertiary);
            padding: 1rem;
            border-radius: var(--radius-sm);
            overflow-x: auto;
            margin: 1rem 0;
        }

        .preview-content ul,
        .preview-content ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        .preview-content li {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-tertiary);
            gap: 1rem;
        }

        .empty-state-icon {
            font-size: 4rem;
            opacity: 0.3;
        }

        .empty-state-text {
            font-size: 1.125rem;
            font-weight: 500;
        }

        /* Status Bar */
        .status-bar {
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            padding: 0.5rem 1rem;
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: var(--text-tertiary);
        }

        .status-item {
            display: flex;
            gap: 1rem;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 1rem 1.5rem;
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-color);
            z-index: 1000;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .toast.success {
            border-left: 4px solid hsl(142, 76%, 56%);
        }

        .toast.error {
            border-left: 4px solid hsl(0, 84%, 60%);
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* Drop Zone */
        .drop-zone {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: hsla(222, 22%, 10%, 0.95);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
            backdrop-filter: blur(5px);
        }

        .drop-zone.active {
            display: flex;
        }

        .drop-zone-content {
            text-align: center;
            padding: 3rem;
            border: 3px dashed var(--accent-primary);
            border-radius: var(--radius-lg);
            background: var(--bg-secondary);
        }

        .drop-zone-icon {
            font-size: 4rem;
            color: var(--accent-primary);
            margin-bottom: 1rem;
        }

        .drop-zone-text {
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* User Profile */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--accent-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .user-name {
            font-size: 0.875rem;
            font-weight: 500;
        }

        .btn-logout {
            padding: 0.5rem 1rem;
            background: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
        }

        .btn-logout:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        /* Auth Modal */
        .auth-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(3, 7, 18, 0.8);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: overlayFadeIn 0.4s ease;
        }

        @keyframes overlayFadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .auth-modal {
            background: rgba(17, 24, 39, 0.6);
            backdrop-filter: blur(24px);
            border-radius: 24px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            width: 90%;
            max-width: 480px;
            padding: 3rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .auth-modal::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: radial-gradient(circle at top, rgba(139, 92, 246, 0.15), transparent 70%);
            pointer-events: none;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-80px) scale(0.95);
                opacity: 0;
            }

            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .auth-header {
            text-align: center;
            margin-bottom: 2.5rem;
            position: relative;
            z-index: 1;
        }

        .auth-header h2 {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }

        .auth-header p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .auth-tabs {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 2rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 0.4rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .auth-tab {
            flex: 1;
            padding: 0.75rem 1rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 10px;
            transition: var(--transition);
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .auth-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
        }

        .auth-tab.active {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 1.25rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-input {
            padding: 0.875rem 1.125rem;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: var(--text-primary);
            font-size: 0.95rem;
            font-family: inherit;
            transition: var(--transition);
        }

        .form-input:hover {
            border-color: rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 4px rgba(139, 92, 246, 0.15);
            background: rgba(0, 0, 0, 0.4);
        }

        .form-input::placeholder {
            color: var(--text-tertiary);
        }

        .btn-auth {
            padding: 1rem 1.5rem;
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            font-family: inherit;
            margin-top: 0.75rem;
            box-shadow: 0 4px 14px rgba(139, 92, 246, 0.35);
        }

        .btn-auth:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(139, 92, 246, 0.5);
        }

        .error-message {
            background: hsla(0, 84%, 60%, 0.1);
            border: 1px solid hsl(0, 84%, 60%);
            color: hsl(0, 84%, 70%);
            padding: 0.75rem;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .success-message {
            background: hsla(142, 76%, 56%, 0.1);
            border: 1px solid hsl(142, 76%, 56%);
            color: hsl(142, 76%, 66%);
            padding: 0.75rem;
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .password-strength {
            height: 4px;
            border-radius: 2px;
            background: var(--bg-tertiary);
            margin-top: 0.25rem;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            transition: var(--transition);
            border-radius: 2px;
        }

        .password-strength-bar.weak {
            width: 33%;
            background: hsl(0, 84%, 60%);
        }

        .password-strength-bar.medium {
            width: 66%;
            background: hsl(45, 100%, 51%);
        }

        .password-strength-bar.strong {
            width: 100%;
            background: hsl(142, 76%, 56%);
        }

        /* Guest Mode */
        .guest-mode-section {
            margin-top: 1.5rem;
        }

        .auth-divider {
            display: flex;
            align-items: center;
            margin: 1.5rem 0;
            color: var(--text-tertiary);
            font-size: 0.85rem;
        }

        .auth-divider::before,
        .auth-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        }

        .auth-divider span {
            padding: 0 1rem;
            opacity: 0.7;
        }

        .btn-guest {
            width: 100%;
            padding: 0.875rem 1.25rem;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            transition: var(--transition);
        }

        .btn-guest:hover {
            background: rgba(139, 92, 246, 0.1);
            border-color: rgba(139, 92, 246, 0.4);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .btn-guest-icon {
            font-size: 1.1rem;
        }

        .btn-guest-badge {
            background: rgba(139, 92, 246, 0.1);
            color: var(--accent-primary);
            font-size: 0.75rem;
            padding: 0.2rem 0.6rem;
            border-radius: 20px;
            border: 1px solid rgba(139, 92, 246, 0.2);
            font-weight: 600;
            margin-left: auto;
        }

        /* Hidden */
        #file-input {
            display: none;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 240px;
                position: fixed;
                left: -240px;
                top: 0;
                height: 100vh;
                z-index: 1000;
                transition: left 0.3s ease;
            }

            .sidebar.active {
                left: 0;
            }

            .search-box {
                width: 200px;
            }

            .header {
                padding: 0.75rem 1rem;
            }

            .auth-modal {
                padding: 1.5rem;
            }
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }

        .mobile-only {
            display: none;
        }

        /* Settings Styles */
        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .setting-item:last-child {
            border-bottom: none;
        }

        .setting-label {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            font-size: 0.95rem;
            color: var(--text-primary);
            font-weight: 500;
            cursor: pointer;
        }

        .setting-label input[type="checkbox"] {
            width: 1.25rem;
            height: 1.25rem;
            cursor: pointer;
            accent-color: var(--accent-primary);
        }
    </style>
</head>

<body>
    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Authentication Overlay -->
    <div class="auth-overlay" id="authOverlay">
        <div class="auth-modal">
            <div class="auth-header">
                <h2>üîê DocViewer Pro</h2>
                <p>Inicia sesi√≥n o reg√≠strate para continuar</p>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTabBtn">Iniciar Sesi√≥n</button>
                <button class="auth-tab" id="registerTabBtn">Registrarse</button>
            </div>

            <div class="error-message" id="authError"></div>
            <div class="success-message" id="authSuccess"></div>

            <!-- Login Form -->
            <form class="auth-form" id="loginForm">
                <div class="form-group">
                    <label class="form-label" for="loginUsername">Usuario o Email</label>
                    <input type="text" class="form-input" id="loginUsername" placeholder="Ingresa tu usuario" required
                        autocomplete="username">
                </div>
                <div class="form-group">
                    <label class="form-label" for="loginPassword">Contrase√±a</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="Ingresa tu contrase√±a"
                        required autocomplete="current-password">
                </div>
                <button type="submit" class="btn-auth">Iniciar Sesi√≥n</button>
            </form>

            <!-- Register Form -->
            <form class="auth-form" id="registerForm" style="display: none;">
                <div class="form-group">
                    <label class="form-label" for="registerUsername">Usuario</label>
                    <input type="text" class="form-input" id="registerUsername" placeholder="Elige un nombre de usuario"
                        required autocomplete="username">
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerEmail">Email</label>
                    <input type="email" class="form-input" id="registerEmail" placeholder="tu@email.com" required
                        autocomplete="email">
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerPassword">Contrase√±a</label>
                    <input type="password" class="form-input" id="registerPassword"
                        placeholder="Crea una contrase√±a segura" required autocomplete="new-password">
                    <div class="password-strength">
                        <div class="password-strength-bar" id="passwordStrengthBar"></div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="registerPasswordConfirm">Confirmar Contrase√±a</label>
                    <input type="password" class="form-input" id="registerPasswordConfirm"
                        placeholder="Confirma tu contrase√±a" required autocomplete="new-password">
                </div>
                <button type="submit" class="btn-auth">Registrarse</button>
            </form>

            <!-- Guest Mode Section -->
            <div class="guest-mode-section">
                <div class="auth-divider">
                    <span>o</span>
                </div>
                <button type="button" id="guestModeBtn" class="btn-guest">
                    <span class="btn-guest-icon">üëÅ</span>
                    <span>Continuar sin registro</span>
                    <span class="btn-guest-badge">Solo lectura</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Overlay -->
    <div class="auth-overlay" id="settingsOverlay" style="display: none; z-index: 10000;">
        <div class="auth-modal" style="max-width: 400px;">
            <div class="auth-header" style="margin-bottom: 1.5rem;">
                <h2>‚öôÔ∏è Configuraci√≥n</h2>
                <p>Personaliza tu experiencia de edici√≥n</p>
            </div>

            <div class="settings-form">
                <div class="setting-item">
                    <label class="setting-label">Tama√±o de Fuente</label>
                    <input type="number" id="fontSizeInput" class="form-input" value="14" min="10" max="30"
                        style="width: 80px;">
                </div>

                <div class="setting-item">
                    <label class="setting-label">
                        <span>Minimapa</span>
                        <input type="checkbox" id="minimapToggle" checked>
                    </label>
                </div>

                <div class="setting-item">
                    <label class="setting-label">
                        <span>Ajuste de L√≠nea (Word Wrap)</span>
                        <input type="checkbox" id="wordWrapToggle" checked>
                    </label>
                </div>

                <div class="setting-item">
                    <label class="setting-label">
                        <span>N√∫meros de L√≠nea</span>
                        <input type="checkbox" id="lineNumbersToggle" checked>
                    </label>
                </div>
            </div>

            <button class="btn-auth" id="closeSettingsBtn" style="margin-top: 1.5rem;">Guardar y Cerrar</button>
        </div>
    </div>

    <!-- Drop Zone -->
    <div class="drop-zone" id="dropZone">
        <div class="drop-zone-content">
            <div class="drop-zone-icon">üìÅ</div>
            <div class="drop-zone-text">Suelta archivos aqu√≠ para cargarlos</div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">
                <div class="logo-icon">üìö</div>
                <span>DocViewer Pro</span>
            </div>
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="searchInput" placeholder="Buscar en archivos...">
            </div>
        </div>
        <div class="header-actions">
            <button class="btn btn-secondary" id="uploadBtn">
                üì§ Subir Archivos
            </button>
            <button class="btn btn-primary" id="downloadBtn">
                üíæ Descargar
            </button>
            <button class="btn-icon" id="toggleSidebar" title="Toggle sidebar">
                ‚ò∞
            </button>
            <button class="btn-icon" id="themeToggle" title="Cambiar tema">
                üåô
            </button>
            <div class="user-profile" id="userProfile" style="display: none;">
                <div class="user-avatar" id="userAvatar"></div>
                <span class="user-name" id="userName"></span>
                <button class="btn-logout" id="logoutBtn">Cerrar Sesi√≥n</button>
            </div>
        </div>
    </header>

    <!-- Hidden file input -->
    <input type="file" id="file-input" multiple>

    <!-- Main Container -->
    <div class="main-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <span class="sidebar-title">Archivos</span>

            </div>
            <div class="file-tree" id="fileTree">
                <!-- Files will be populated here -->
            </div>
        </aside>

        <!-- Content Area -->
        <main class="content-area">
            <div class="tabs-container" id="tabsContainer">
                <div class="tab active" id="editorTab">
                    ‚úèÔ∏è Editor
                </div>
                <div class="tab" id="previewTab">
                    üëÅÔ∏è Vista Previa
                </div>
            </div>

            <div class="editor-toolbar">
                <button class="btn-icon" id="saveBtn" title="Guardar (Ctrl+S)">üíæ</button>
                <button class="btn-icon" id="undoBtn" title="Deshacer (Ctrl+Z)">‚Ü∂</button>
                <button class="btn-icon" id="redoBtn" title="Rehacer (Ctrl+Y)">‚Ü∑</button>
                <div class="toolbar-separator"></div>
                <button class="btn-icon" id="toggleColorBtn" title="Alternar coloreado">üé®</button>
                <button class="btn-icon" id="findBtn" title="Buscar (Ctrl+F)">üîç</button>
                <div class="toolbar-separator"></div>
                <button class="btn-icon" id="settingsBtn" title="Configuraci√≥n">‚öôÔ∏è</button>
            </div>

            <div class="editor-container" id="editorContainer">
                <div class="empty-state" id="emptyState">
                    <div class="empty-state-icon">üìÑ</div>
                    <div class="empty-state-text">Selecciona o carga un archivo para comenzar</div>
                    <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">
                        üì§ Subir Archivos
                    </button>
                </div>
                <div id="monaco-editor" style="display: none;"></div>
                <div class="preview-container" id="previewContainer" style="display: none;">
                    <div class="preview-content" id="previewContent"></div>
                </div>
            </div>

            <div class="status-bar">
                <div class="status-item">
                    <span id="statusText">Listo</span>
                </div>
                <div class="status-item">
                    <span id="fileInfo">Sin archivo</span>
                    <span>|</span>
                    <span id="cursorPos">Ln 1, Col 1</span>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Application State
        let editor;
        let currentFile = null;
        let files = [];
        let currentView = 'editor';
        let isDarkTheme = true;

        // Initialize Monaco Editor
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs' } });

        require(['vs/editor/editor.main'], function () {

            // Define Vibrant Aurora Theme
            monaco.editor.defineTheme('vibrant-aurora', {
                base: 'vs-dark',
                inherit: true,
                rules: [
                    { token: '', background: '110d1a' }, // Deep dark violet/blue background
                    { token: 'comment', foreground: '64748b', fontStyle: 'italic' },
                    { token: 'keyword', foreground: 'dd76e8', fontStyle: 'bold' },
                    { token: 'string', foreground: '7dd3fc' },
                    { token: 'number', foreground: 'f472b6' },
                    { token: 'type', foreground: '8b5cf6' },
                ],
                colors: {
                    'editor.background': '#0f172a', // Matches new dark theme or slightly lighter
                    'editor.foreground': '#f8fafc',
                    'editor.lineHighlightBackground': '#1e293b',
                    'editorCursor.foreground': '#06b6d4',
                    'editorWhitespace.foreground': '#334155',
                    'editorIndentGuide.background': '#334155',
                    'editor.selectionBackground': '#3b82f640',
                }
            });

            // Enable Advanced JavaScript IntelliSense (Gemini-like behavior)
            monaco.languages.typescript.javascriptDefaults.setCompilerOptions({
                target: monaco.languages.typescript.ScriptTarget.ES2020,
                allowNonTsExtensions: true,
                checkJs: true,
                allowJs: true,
                typeRoots: ["node_modules/@types"]
            });

            // Allow checking for diagnostics
            monaco.languages.typescript.javascriptDefaults.setDiagnosticsOptions({
                noSemanticValidation: false,
                noSyntaxValidation: false
            });

            editor = monaco.editor.create(document.getElementById('monaco-editor'), {
                value: '',
                language: 'markdown',
                theme: 'vibrant-aurora',
                automaticLayout: true,
                fontSize: 14,
                fontFamily: "'Fira Code', monospace",
                lineNumbers: 'on',
                minimap: { enabled: true },
                scrollBeyondLastLine: false,
                wordWrap: 'on',
                formatOnPaste: true,
                formatOnType: true,
                suggestOnTriggerCharacters: true,
                quickSuggestions: { other: true, comments: true, strings: true },
                wordBasedSuggestions: true, // Ensure words from document are suggested
                acceptSuggestionOnEnter: 'on',
                parameterHints: { enabled: true },
                snippetSuggestions: 'top',
            });

            // Update Status Bar to show AI
            document.getElementById('fileInfo').innerHTML = '‚ú® Gemini AI: Activo';

            // Enhanced "Gemini" IntelliSense for other languages
            // This provides common method suggestions to simulate intelligence without a backend LSP
            const commonLanguages = ['java', 'python', 'cpp', 'csharp', 'php'];

            commonLanguages.forEach(lang => {
                monaco.languages.registerCompletionItemProvider(lang, {
                    triggerCharacters: ['.'],
                    provideCompletionItems: function (model, position) {
                        const word = model.getWordUntilPosition(position);
                        const range = {
                            startLineNumber: position.lineNumber,
                            endLineNumber: position.lineNumber,
                            startColumn: word.startColumn,
                            endColumn: word.endColumn
                        };

                        // Generic helpful methods that might apply to strings/objects in these languages
                        // This simulates the "Gemini" helping out with methods
                        const suggestions = [
                            { label: 'toString', insertText: 'toString()', kind: monaco.languages.CompletionItemKind.Method, detail: 'Gemini Auto-Suggest' },
                            { label: 'length', insertText: 'length()', kind: monaco.languages.CompletionItemKind.Method, detail: 'Gemini Auto-Suggest' },
                            { label: 'substring', insertText: 'substring(${1:start}, ${2:end})', kind: monaco.languages.CompletionItemKind.Snippet, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'indexOf', insertText: 'indexOf(${1:value})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'equals', insertText: 'equals(${1:obj})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'toLowerCase', insertText: 'toLowerCase()', kind: monaco.languages.CompletionItemKind.Method, detail: 'Gemini Auto-Suggest' },
                            { label: 'toUpperCase', insertText: 'toUpperCase()', kind: monaco.languages.CompletionItemKind.Method, detail: 'Gemini Auto-Suggest' },
                            { label: 'trim', insertText: 'trim()', kind: monaco.languages.CompletionItemKind.Method, detail: 'Gemini Auto-Suggest' },
                            { label: 'split', insertText: 'split(${1:regex})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'replace', insertText: 'replace(${1:old}, ${2:new})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'print', insertText: 'print(${1:message})', kind: monaco.languages.CompletionItemKind.Function, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            // Add some specific Java/Python ones mixed in
                            { label: 'append', insertText: 'append(${1:str})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'get', insertText: 'get(${1:index})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'set', insertText: 'set(${1:index}, ${2:element})', kind: monaco.languages.CompletionItemKind.Method, insertTextRules: monaco.languages.CompletionItemInsertTextRule.InsertAsSnippet, detail: 'Gemini Auto-Suggest' },
                            { label: 'size', insertText: 'size()', kind: monaco.languages.CompletionItemKind.Method, detail: 'Gemini Auto-Suggest' },
                        ];

                        return { suggestions: suggestions.map(s => ({ ...s, range })) };
                    }
                });
            });

            editor.onDidChangeCursorPosition((e) => {
                updateCursorPosition(e.position.lineNumber, e.position.column);
            });

            editor.onDidChangeModelContent(() => {
                if (currentFile) {
                    currentFile.modified = true;
                    updateFileTree();
                    if (currentView === 'preview') {
                        updatePreview();
                    }
                }
            });

            addSampleFiles();
            loadSettings(); // Apply saved settings
        });

        // Sample Files
        function addSampleFiles() {
            const sampleFiles = [
                {
                    name: 'README.md',
                    type: 'markdown',
                    content: `# Bienvenido a DocViewer Pro

## Caracter√≠sticas principales

- **Editor de c√≥digo avanzado** con resaltado de sintaxis
- **Vista previa en tiempo real** para archivos Markdown
- **B√∫squeda r√°pida** en el contenido de los archivos
- **Descarga individual** de archivos
- **Carga m√∫ltiple** de archivos mediante drag & drop
- **Interfaz moderna** con animaciones suaves

## C√≥mo usar

1. Sube archivos usando el bot√≥n "Subir Archivos" o arrastra archivos a la ventana
2. Selecciona un archivo del √°rbol lateral
3. Edita el contenido en el editor
4. Usa la vista previa para ver el resultado
5. Descarga los archivos modificados

## Formatos soportados

- Markdown (.md)
- JavaScript (.js)
- HTML (.html)
- CSS (.css)
- JSON (.json)
- Python (.py)
- Y muchos m√°s...

¬°Disfruta editando tus documentos! üöÄ`
                },
                {
                    name: 'ejemplo.js',
                    type: 'javascript',
                    content: `// Ejemplo de c√≥digo JavaScript

class DocumentManager {
    constructor() {
        this.files = [];
        this.currentFile = null;
    }

    addFile(file) {
        this.files.push(file);
        console.log(\`Archivo agregado: \${file.name}\`);
    }

    removeFile(fileName) {
        this.files = this.files.filter(f => f.name !== fileName);
        console.log(\`Archivo eliminado: \${fileName}\`);
    }

    getFile(fileName) {
        return this.files.find(f => f.name === fileName);
    }
}

// Uso
const manager = new DocumentManager();
manager.addFile({ name: 'test.txt', content: 'Hello World' });`
                },
                {
                    name: 'estilos.css',
                    type: 'css',
                    content: `/* Estilos de ejemplo */

:root {
    --primary-color: #6366f1;
    --secondary-color: #8b5cf6;
    --background: #1e1e2e;
    --text-color: #ffffff;
}

body {
    font-family: 'Inter', sans-serif;
    background: var(--background);
    color: var(--text-color);
    margin: 0;
    padding: 0;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

.btn {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s;
}

.btn:hover {
    transform: translateY(-2px);
}`
                }
            ];

            sampleFiles.forEach(file => {
                files.push({
                    name: file.name,
                    content: file.content,
                    type: file.type,
                    modified: false
                });
            });

            updateFileTree();
        }

        // File Tree Management
        function updateFileTree() {
            const fileTree = document.getElementById('fileTree');
            fileTree.innerHTML = '';

            files.forEach((file, index) => {
                const item = document.createElement('div');
                item.className = `tree-item${currentFile === file ? ' active' : ''}`;
                item.innerHTML = `
                    <span class="tree-item-icon">${getFileIcon(file.type)}</span>
                    <span class="tree-item-name">${file.name}${file.modified ? ' ‚Ä¢' : ''}</span>
                `;
                item.onclick = () => openFile(file);
                fileTree.appendChild(item);
            });
        }

        function getFileIcon(type) {
            const icons = {
                'markdown': 'üìù',
                'javascript': 'üü®',
                'css': 'üé®',
                'html': 'üåê',
                'json': 'üìã',
                'python': 'üêç',
                'default': 'üìÑ'
            };
            return icons[type] || icons.default;
        }

        function getLanguage(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const languages = {
                'md': 'markdown',
                'js': 'javascript',
                'ts': 'typescript',
                'html': 'html',
                'css': 'css',
                'json': 'json',
                'py': 'python',
                'java': 'java',
                'cpp': 'cpp',
                'c': 'c',
                'cs': 'csharp',
                'php': 'php',
                'rb': 'ruby',
                'go': 'go',
                'rs': 'rust',
                'swift': 'swift',
                'kt': 'kotlin',
                'xml': 'xml',
                'yml': 'yaml',
                'yaml': 'yaml'
            };
            return languages[ext] || 'plaintext';
        }

        function openFile(file) {
            currentFile = file;
            updateFileTree();

            // Force switch to editor view
            document.getElementById('editorTab').click();

            // The click handler above handles display toggling, we just need to set content
            const language = getLanguage(file.name);
            monaco.editor.setModelLanguage(editor.getModel(), language);
            editor.setValue(file.content);

            document.getElementById('fileInfo').textContent = file.name;
            document.getElementById('statusText').textContent = 'Archivo cargado';
        }

        // View Switching
        document.getElementById('editorTab').onclick = () => {
            currentView = 'editor';
            document.getElementById('editorTab').classList.add('active');
            document.getElementById('previewTab').classList.remove('active');
            document.getElementById('monaco-editor').style.display = currentFile ? 'block' : 'none';
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('emptyState').style.display = currentFile ? 'none' : 'flex';

            // Show all toolbar buttons
            document.querySelectorAll('.editor-toolbar > *').forEach(el => el.style.display = 'flex');
            document.querySelectorAll('.toolbar-separator').forEach(el => el.style.display = 'block');
        };

        document.getElementById('previewTab').onclick = () => {
            currentView = 'preview';
            document.getElementById('previewTab').classList.add('active');
            document.getElementById('editorTab').classList.remove('active');
            document.getElementById('monaco-editor').style.display = 'none';
            document.getElementById('previewContainer').style.display = 'block';
            document.getElementById('emptyState').style.display = 'none';

            // Show Save and Color Toggle buttons in Preview
            document.querySelectorAll('.editor-toolbar > *').forEach(el => {
                if (el.id === 'saveBtn' || el.id === 'toggleColorBtn') {
                    el.style.display = 'flex';
                } else {
                    el.style.display = 'none';
                }
            });
            updatePreview();
        };

        function updatePreview() {
            const content = editor ? editor.getValue() : '';
            const previewContent = document.getElementById('previewContent');

            if (currentFile && currentFile.name.endsWith('.md')) {
                previewContent.innerHTML = marked.parse(content);
                if (isHighlightingEnabled) {
                    previewContent.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                }
            } else {
                if (isHighlightingEnabled && currentFile) {
                    // Try to highlight entire content if not markdown (e.g. JS file view)
                    const langClass = currentFile.type === 'plaintext' ? '' : `language-${currentFile.type}`;
                    previewContent.innerHTML = `<pre><code class="${langClass}">${escapeHtml(content)}</code></pre>`;
                    if (langClass) {
                        hljs.highlightElement(previewContent.querySelector('code'));
                    }
                } else {
                    // Plain text view
                    previewContent.innerHTML = `<pre><code>${escapeHtml(content)}</code></pre>`;
                }
            }
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // File Operations
        function saveFile() {
            if (currentFile && editor) {
                currentFile.content = editor.getValue();
                currentFile.modified = false;
                updateFileTree();
                showToast('Archivo guardado', 'success');
            }
        }

        function downloadFile() {
            if (currentFile) {
                const blob = new Blob([editor.getValue()], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = currentFile.name;
                a.click();
                URL.revokeObjectURL(url);
                showToast('Archivo descargado', 'success');
            }
        }

        // File Upload
        document.getElementById('uploadBtn').onclick = () => {
            document.getElementById('file-input').click();
        };

        document.getElementById('file-input').onchange = (e) => {
            handleFiles(e.target.files);
        };

        function handleFiles(fileList) {
            Array.from(fileList).forEach(file => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const newFile = {
                        name: file.name,
                        content: e.target.result,
                        type: getLanguage(file.name),
                        modified: false
                    };
                    files.push(newFile);
                    updateFileTree();
                    openFile(newFile);
                };
                reader.readAsText(file);
            });
        }

        // Drag and Drop
        document.addEventListener('dragover', (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.add('active');
        });

        document.addEventListener('dragleave', (e) => {
            if (e.relatedTarget === null) {
                document.getElementById('dropZone').classList.remove('active');
            }
        });

        document.addEventListener('drop', (e) => {
            e.preventDefault();
            document.getElementById('dropZone').classList.remove('active');
            handleFiles(e.dataTransfer.files);
        });

        // Toolbar Actions
        document.getElementById('saveBtn').onclick = saveFile;
        document.getElementById('downloadBtn').onclick = downloadFile;
        document.getElementById('undoBtn').onclick = () => editor?.trigger('keyboard', 'undo');
        document.getElementById('redoBtn').onclick = () => editor?.trigger('keyboard', 'redo');
        document.getElementById('findBtn').onclick = () => editor?.trigger('keyboard', 'actions.find');

        // Global Highlighting State
        let isHighlightingEnabled = true;

        document.getElementById('toggleColorBtn').onclick = () => {
            if (!editor || !currentFile) return;

            isHighlightingEnabled = !isHighlightingEnabled;

            if (currentView === 'editor') {
                const model = editor.getModel();
                const originalLang = currentFile.type;

                if (isHighlightingEnabled) {
                    monaco.editor.setModelLanguage(model, originalLang);
                    showToast('Coloreado activado', 'success');
                } else {
                    monaco.editor.setModelLanguage(model, 'plaintext');
                    showToast('Coloreado desactivado', 'info');
                }
            } else if (currentView === 'preview') {
                updatePreview(); // Re-render preview with/without color
                showToast(isHighlightingEnabled ? 'Coloreado activado' : 'Coloreado desactivado', isHighlightingEnabled ? 'success' : 'info');
            }
        };

        // Settings Logic
        const settingsOverlay = document.getElementById('settingsOverlay');
        const settingsBtn = document.getElementById('settingsBtn');
        const closeSettingsBtn = document.getElementById('closeSettingsBtn');

        // Load Settings
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('docViewerSettings')) || {
                fontSize: 14,
                minimap: true,
                wordWrap: 'on',
                lineNumbers: 'on'
            };

            document.getElementById('fontSizeInput').value = settings.fontSize;
            document.getElementById('minimapToggle').checked = settings.minimap;
            document.getElementById('wordWrapToggle').checked = settings.wordWrap === 'on';
            document.getElementById('lineNumbersToggle').checked = settings.lineNumbers === 'on';

            applySettings(settings);
        }

        function applySettings(settings) {
            if (editor) {
                editor.updateOptions({
                    fontSize: parseInt(settings.fontSize),
                    minimap: { enabled: settings.minimap },
                    wordWrap: settings.wordWrap,
                    lineNumbers: settings.lineNumbers
                });
            }
        }

        function saveSettings() {
            const settings = {
                fontSize: document.getElementById('fontSizeInput').value,
                minimap: document.getElementById('minimapToggle').checked,
                wordWrap: document.getElementById('wordWrapToggle').checked ? 'on' : 'off',
                lineNumbers: document.getElementById('lineNumbersToggle').checked ? 'on' : 'off'
            };

            localStorage.setItem('docViewerSettings', JSON.stringify(settings));
            applySettings(settings);
            showToast('Configuraci√≥n guardada', 'success');
        }

        settingsBtn.onclick = () => {
            settingsOverlay.style.display = 'flex';
        };

        closeSettingsBtn.onclick = () => {
            saveSettings();
            settingsOverlay.style.display = 'none';
        };

        // Close on click outside
        settingsOverlay.onclick = (e) => {
            if (e.target === settingsOverlay) {
                settingsOverlay.style.display = 'none';
            }
        };




        // Toggle Sidebar
        document.getElementById('toggleSidebar').onclick = () => {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');

            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('active');
                overlay.classList.toggle('active');
            } else {
                sidebar.style.display = sidebar.style.display === 'none' ? 'flex' : 'none';
            }
        };

        document.getElementById('sidebarOverlay').onclick = () => {
            document.getElementById('sidebar').classList.remove('active');
            document.getElementById('sidebarOverlay').classList.remove('active');
        };

        // Search
        document.getElementById('searchInput').oninput = (e) => {
            const query = e.target.value.toLowerCase();
            const items = document.querySelectorAll('.tree-item');
            items.forEach(item => {
                const name = item.querySelector('.tree-item-name').textContent.toLowerCase();
                item.style.display = name.includes(query) ? 'flex' : 'none';
            });
        };

        // Theme Toggle
        document.getElementById('themeToggle').onclick = () => {
            isDarkTheme = !isDarkTheme;
            if (editor) {
                monaco.editor.setTheme(isDarkTheme ? 'vs-dark' : 'vs-light');
            }
            document.getElementById('themeToggle').textContent = isDarkTheme ? 'üåô' : '‚òÄÔ∏è';
        };

        // Keyboard Shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 's') {
                    e.preventDefault();
                    saveFile();
                }
            }
        });

        // Cursor Position
        function updateCursorPosition(line, col) {
            document.getElementById('cursorPos').textContent = `Ln ${line}, Col ${col}`;
        }

        // Toast Notifications
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<span>${type === 'success' ? '‚úì' : '‚úó'}</span><span>${message}</span>`;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
    </script>

    <!-- Authentication Script -->
    <script src="auth.js"></script>

</body>

</html>